<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>ЗАКАЗЫ</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    table { width: 100%; border-collapse: collapse; }
    table, th, td { border: 1px solid black; }
    th, td { padding: 8px; text-align: left; }
  </style>
</head>
<body>
  <h1>ЗАКАЗЫ</h1>
  <table>
    <thead>
      <tr>
        <th>Имя</th>
        <th>Телефон</th>
        <th>Адрес</th>
        <th>Товары</th>
        <th>Сумма</th>
        <th>PDF</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Иван Иванов</td>
        <td>77001234567</td>
        <td>г. Алматы, ул. Абая, д. 25</td>
        <td>
          1. Хлеб (150₸) × 2<br>
          2. Молоко (250₸) × 1
        </td>
        <td>550₸</td>
        <td><button onclick="saveAsPDF()">Сохранить PDF</button></td>
      </tr>
    </tbody>
  </table>

  <script>
    async function saveAsPDF() {
      const { jsPDF } = window.jspdf;

      const doc = new jsPDF();

      // Загружаем кириллический шрифт Roboto
      const fontUrl = 'https://unpkg.com/pdfmake@0.1.36/build/vfs_fonts.js';
      const fontRes = await fetch(fontUrl);
      const fontScript = await fontRes.text();
      eval(fontScript); // загружаем pdfMake.vfs

      const roboto = pdfMake.vfs['Roboto-Regular.ttf'];
      doc.addFileToVFS('Roboto-Regular.ttf', roboto);
      doc.addFont('Roboto-Regular.ttf', 'Roboto', 'normal');
      doc.setFont('Roboto');

      // Добавляем текст на русском
      doc.setFontSize(12);
      doc.text("Заказ от: Иван Иванов", 10, 20);
      doc.text("Телефон: 77001234567", 10, 30);
      doc.text("Адрес: г. Алматы, ул. Абая, д. 25", 10, 40);
      doc.text("Товары:", 10, 50);
      doc.text("1. Хлеб (150₸) × 2", 10, 60);
      doc.text("2. Молоко (250₸) × 1", 10, 70);
      doc.text("Общая сумма: 550₸", 10, 90);

      doc.save('zakaz.pdf');
    }
  </script>
</body>
</html>
